---
import WelcomeLeftAligned from "@/components/WelcomeLeftAligned.astro";
import Layout from "@/layouts/Layout.astro";
import Products from "@/components/Products.astro";
import Scribble from "@/assets/feuchter_gmbh_header.jpg";
import ProductGrid from "@/components/ProductGrid.astro";
import HeaderImage from "@/assets/transportwand_header.jpg";
import products from "@/content/transportProducts";
import { transportCategories } from "@/content/transportCategories";
import type { AstroLocals } from "@/types";
const { locals } = Astro as unknown as { locals: AstroLocals };
const { url } = Astro.request;
const searchParams = new URL(url).searchParams;
const searchCategory = searchParams.get("category");
const pageLanguage = locals.language;
let categories = Array.from(
  new Set(
    products
      .filter(
        (product) =>
          product.category.key ==
            transportCategories[product.category.key].key &&
          product.category.overall == searchCategory,
      )
      .map((product) => {
        return {
          key: product.category.key,
          value: transportCategories[product.category.key][pageLanguage],
        };
      }),
  ),
);
categories = [...new Map(categories.map((item) => [item.key, item])).values()];
if (categories.length == 0) {
  console.log("found none");
  return new Response(null, { status: 404 });
}

const links = [
  {
    href: `transportsolutions?category=protective-wall`,
    searchCategory: "protective-wall",
    linkText: {
      de: "Schutzwand für Rollcontainer",
      en: "Protective Wall for Roll Cage Trolleys",
    },
  },
  {
    href: `transportsolutions?category=thermal-cover`,
    searchCategory: "thermal-cover",
    linkText: {
      de: "Thermohaube für Rollcontainer",
      en: "Thermal Cover for Roll Cage Trolleys",
    },
  },
  {
    href: `transportsolutions?category=dust-cover`,
    searchCategory: "dust-cover",
    linkText: {
      de: "Schutzhaube für Rollcontainer",
      en: "Dust Cover for Roll Cage Trolleys",
    },
  },
];

let heading =
  "Von Militär- & Survivalkleidung über Behördenkleidung bis hin zu feinster Corporate Fashion";
let subtitle = "Egal ob für Armeen, Behörden, Onlineshops oder Unternehmen";
let introText = `Von robuster Militär- und Survivalkleidung über funktionale Behördenausstattung bis hin zu maßgeschneiderter Corporate Fashion – wir statten Sie aus. Ob für Armeen, Einsatzkräfte, Onlineshops oder Unternehmen: Unsere Produkte vereinen Qualität, Funktionalität und Design auf höchstem Niveau. Vertrauen Sie auf Erfahrung, Präzision und textile Lösungen, die den Unterschied machen.`;
if (pageLanguage == "en") {
  heading =
    "From military and survival clothing to official uniforms and premium corporate fashion";
  subtitle =
    "Whether for armed forces, government agencies, online retailers, or businesses";
  introText = `From rugged military and survival apparel to functional gear for authorities and tailored corporate fashion – we’ve got you covered. Whether for armed forces, emergency services, online retailers, or businesses: our products combine quality, functionality, and design at the highest level. Rely on experience, precision, and textile solutions that make a difference.`;
}
---

<Layout>
  <ProductGrid
    categories={categories}
    products={products}
    pageLanguage={pageLanguage}
    searchCategory={searchCategory}
    links={links}
    headerImage={HeaderImage}
    heading={heading}
    introText={introText}
    subtitle={subtitle}
  />
</Layout>
